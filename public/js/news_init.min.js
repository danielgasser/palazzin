var fillPostContent=function(a,b){return"1"===$("#edit").val()?"<a id=\"link_post_"+a.id+"\"></a><div class=\"row postrow\"><div class=\"col-sm-3 col-md-3 col-xs-12 posts\">"+a.created_at+"<br><h4><a href=\""+window.urlTo+"user/profile/"+a.user_id+"\">"+a.user_first_name+" "+a.user_name+"</a></h4>"+b+"</div><div class=\"col-sm-9 col-md-9 col-xs-12 post-entry\">"+a.post_text+"</div></div>":"<div id=\"post_"+a.id+"\"><a id=\"link_post_"+a.id+"\"></a><div class=\"row postrow\"><div class=\"col-sm-3 col-md-3 col-xs-12 posts\">"+a.created_at+"<br><h4><a href=\""+window.urlTo+"user/profile/"+a.user_id+"\">"+a.user_first_name+" "+a.user_name+"</a></h4>"+b+"</div><div class=\"col-sm-9 col-md-9 col-xs-12 post-entry\">"+a.post_text+"</div></div></div>"};$(document).ready(function(){"use strict";CKEDITOR.replace("post_text",{config:{extraPlugins:"uploadimage"}}),window.localStorage.hasOwnProperty("news_hash")&&(window.location.hash=window.localStorage.getItem("news_hash"),window.localStorage.removeItem("news_hash")),$(document).on("click","#add_post",function(a){a.preventDefault(),$("#newstickerNewPost").slideToggle("slow"),GlobalFunctions.scrollIt("#wrap","slow"),$("#post_text").val(""),$("#edit").val("0")}),$(document).on("click","#cancel_new_post",function(a){a.preventDefault(),$("#newstickerNewPost").slideUp("slow"),$("[id^=\"closeComment_\"]").trigger("click"),$("#post_text").val(""),$("#edit").val("0")}),$(document).on("click","[id^=\"editPost_\"]",function(a){a.preventDefault(),$.ajax({type:"GET",url:"news/getone",data:{id:$(this).attr("id").split("_")[1]},success:function(a){GlobalFunctions.unAuthorized(a),GlobalFunctions.scrollIt("#wrap","slow"),$("#newstickerNewPost").slideDown("slow").promise().always(function(){window.CKEDITOR.instances.post_text.setData(a.post_text)}),$("#edit").val("1"),$("#post_text").val(a.post_text),$("#id").val(a.id)}})}),$(document).on("click","[id^=\"deletePost_\"]",function(){var a=$(this).attr("id").split("_")[1];$.ajax({type:"POST",url:"news/delete",data:{id:a},success:function(b){GlobalFunctions.unAuthorized(b),$("#post_"+a).remove()}})}),$(document).on("click","#save_new_post",function(a){a.preventDefault(),$("#newstickerNewPost").slideUp("slow"),"0"===$("#edit").val()&&$("#post_"+$("#id").val()).remove(),$.ajax({type:"POST",url:"news",data:{post_text:window.CKEDITOR.instances.post_text.getData(),id:$("#id").val()},success:function(a){GlobalFunctions.unAuthorized(a);var b,c="",d=a[0][0],e=a.auth;e===d.uid&&(c="<div class=\"tools\"><span id=\"editPost_"+d.id+"\" class=\"glyphicon glyphicon-pencil edit\"></span><span id=\"deletePost_"+d.id+"\" class=\"glyphicon glyphicon-remove edit\"></span></div>"),b=fillPostContent(d,c),"1"===$("#edit").val()?($("#post_"+d.id).html(b),GlobalFunctions.scrollIt("#post_"+d.id,"slow")):$("#newsticker").prepend(b),$("#confirm_notify_new_post").attr("data-id",d.id),$("#notify_new_post").modal(),BrowserNotification.notifyMe("Neuer Beitrag auf palazzin.ch","Neuer Post im News-Ticker","/news#link_post_"+d.id)}})}),$(document).on("click","#confirm_notify_new_post",function(a){a.preventDefault();let b=$(this).attr("data-id"),c=$("#notify_new_post"),e=c.find(".modal-header"),f=c.find(".modal-body"),g=c.find(".modal-footer");$.ajax({url:"notify_new_post",method:"POST",data:{post_id:b},success:function(a){let b=$.parseJSON(a);b.hasOwnProperty("success")?(f.html("<p>"+b.success+"</p>"),g.html("<button class=\"btn btn-default btn-dialog-left close\" data-dismiss=\"modal\" aria-label=\"Close\">Ok</button>")):(e.addClass("modal-title-info").removeClass("modal-title-warning").html("<h4>Warnung</h4>"),f.html("<p>"+b.error+"</p>"),g.html("<button class=\"btn btn-default btn-dialog-left close\" data-dismiss=\"modal\" aria-label=\"Close\">Ok</button>")),$("#loading").hide()}})})});